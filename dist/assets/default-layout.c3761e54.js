import{u as V,i as Le,a as z,l as Ce,j as ne,r as $e,o as we,_ as U,b as oe,k as Me,m as W,R as De,D as Se,n as Te}from"./index.917dbba1.js";import{F as Be}from"./index.58407c1f.js";import{aV as Ee,c as x,d as F,e as A,aJ as o,bK as Re,bL as Ie,h as Q,bM as Z,bN as Fe,bO as Pe,aG as M,B as p,aD as y,aI as t,D as H,F as g,aN as T,aO as D,C as I,aL as J,aK as X,E as O,aE as E,bJ as Ae,bt as Ue,bi as se,bP as ze,b7 as ae,bp as Ne,bQ as Ke,bR as Oe,bk as Ve,bS as je,r as qe,t as We,u as f,bc as He,bT as Je,aW as ce,bU as Xe,aY as Ye,i as Ge,bf as Qe,bx as Ze,bV as et,bz as tt,bE as re,by as le,bW as nt,b9 as ie,ba as ue,w as de,b2 as ot,bX as st,o as _e,bY as at,b as ct,bZ as rt,bs as ee,b_ as lt,bB as it,b$ as ut,c0 as dt,aX as _t,c1 as pt,c2 as ft,p as ht}from"./arco.af438d9f.js";import{f as j,h as Y,i as mt,j as gt,k as vt,l as yt}from"./vue.d426fe84.js";/* empty css              *//* empty css              *//* empty css               *//* empty css               *//* empty css                */import{l as te}from"./logo.f3610a8b.js";/* empty css               */import{u as bt}from"./loading.275920af.js";/* empty css                *//* empty css               *//* empty css              *//* empty css               */import"./chart.a344a590.js";function kt(){const n=j(),s=V();return{logout:async i=>{await s.logout();const u=n.currentRoute.value;Ee.success("\u767B\u51FA\u6210\u529F"),n.push({name:i&&typeof i=="string"?i:"login",query:{...n.currentRoute.value.query,redirect:u.name}})}}}function pe(){const n=V();return{accessRouter(s){var c,i,u,v,r,h;return!((c=s.meta)!=null&&c.requiresAuth)||!((i=s.meta)!=null&&i.roles)||((v=(u=s.meta)==null?void 0:u.roles)==null?void 0:v.includes("*"))||((h=(r=s.meta)==null?void 0:r.roles)==null?void 0:h.includes(n.role))},findFirstPermissionRoute(s,c="admin"){var u,v;const i=[...s];for(;i.length;){const r=i.shift();if((v=(u=r==null?void 0:r.meta)==null?void 0:u.roles)!=null&&v.find(h=>h.includes("*")||h.includes(c)))return{name:r.name};r!=null&&r.children&&i.push(...r.children)}return null}}}const xt=[...Le],Lt=xt.map(n=>{const{name:s,path:c,meta:i,redirect:u,children:v}=n;return{name:s,path:c,meta:i,redirect:u,children:v}}),Ct=Lt;function $t(){const n=pe(),s=z(),c=x(()=>s.menuFromServer?s.appAsyncMenus:Ct);return{menuTree:x(()=>{const u=Ce.exports.cloneDeep(c.value);u.sort((r,h)=>(r.meta.order||0)-(h.meta.order||0));function v(r,h){return r?r.map(m=>{var w,d;if(!n.accessRouter(m))return null;if(((w=m.meta)==null?void 0:w.hideChildrenInMenu)||!m.children)return m.children=[],m;m.children=m.children.filter(b=>{var _;return((_=b.meta)==null?void 0:_.hideInMenu)!==!0});const $=v(m.children,h+1);return $.length||h>1?(m.children=$,m):((d=m.meta)==null?void 0:d.hideInMenu)===!1?m:null}).filter(Boolean):null}return v(u,0)})}}function wt(n){return typeof n=="function"||Object.prototype.toString.call(n)==="[object Object]"&&!Ie(n)}const Mt=F({emit:["collapse"],setup(){const n=z(),s=j(),c=Y(),{menuTree:i}=$t(),u=x({get(){return n.device==="desktop"?n.menuCollapse:!1},set(d){n.updateSettings({menuCollapse:d})}}),v=x(()=>n.topMenu),r=A([]),h=A([]),C=d=>{if($e.test(d.path)){we(d.path),h.value=[d.name];return}const{hideInMenu:b,activeMenu:_}=d.meta;if(c.name===d.name&&!b&&!_){h.value=[d.name];return}s.push({name:d.name})},m=d=>{const b=[];let _=!1;const e=(a,k)=>{var l;if(a.name===d){_=!0,b.push(...k);return}(l=a.children)!=null&&l.length&&a.children.forEach(L=>{e(L,[...k,L.name])})};return i.value.forEach(a=>{_||e(a,[a.name])}),b};ne(d=>{const{requiresAuth:b,activeMenu:_,hideInMenu:e}=d.meta;if(b&&(!e||_)){const a=m(_||d.name),k=new Set([...a,...r.value]);r.value=[...k],h.value=[_||a[a.length-1]]}},!0);const $=d=>{n.device==="desktop"&&n.updateSettings({menuCollapse:d})},w=()=>{function d(b,_=[]){return b&&b.forEach(e=>{var l;const a=(l=e==null?void 0:e.meta)!=null&&l.icon?()=>{var L;return Q(Z(`<${(L=e==null?void 0:e.meta)==null?void 0:L.icon}/>`))}:null,k=(e==null?void 0:e.children)&&(e==null?void 0:e.children.length)!==0?o(Fe,{key:e==null?void 0:e.name},{default:()=>[d(e==null?void 0:e.children)],icon:a,title:()=>{var L;return Q(Z(((L=e==null?void 0:e.meta)==null?void 0:L.title)||""))}}):o(Pe,{key:e==null?void 0:e.name,onClick:()=>C(e)},{default:()=>{var L;return[((L=e==null?void 0:e.meta)==null?void 0:L.title)||""]},icon:a});_.push(k)}),_}return d(i.value)};return()=>{let d;return o(Re,{mode:v.value?"horizontal":"vertical",collapsed:u.value,"onUpdate:collapsed":b=>u.value=b,"open-keys":r.value,"onUpdate:open-keys":b=>r.value=b,"show-collapse-button":n.device!=="mobile","auto-open":!1,"selected-keys":h.value,"auto-open-selected":!0,"level-indent":34,style:"height: 100%;width:100%;",onCollapse:$},wt(d=w())?d:{default:()=>[d]})}}});const q=U(Mt,[["__scopeId","data-v-e8d40732"]]);function Dt(){return oe.post("/api/message/list")}function St(n){return oe.post("/api/message/read",n)}const Tt=["onClick"],Bt=["src"],Et={class:"footer-wrap"},Rt={class:"footer-wrap"},It=F({__name:"list",props:{renderList:{type:Array,required:!0},unreadCount:{type:Number,default:0}},emits:["itemClick"],setup(n,{emit:s}){const c=n,i=()=>{s("itemClick",[...c.renderList])},u=r=>{r.status||s("itemClick",[r])},v=3;return(r,h)=>{const C=Ue,m=M("icon-desktop"),$=se,w=ze,d=ae,b=Ne,_=Ke,e=Oe,a=Ve,k=je;return p(),y(k,{bordered:!1},{footer:t(()=>[o(d,{fill:"",size:0,class:H({"add-border-top":n.renderList.length<v})},{default:t(()=>[g("div",Et,[o(a,{onClick:i},{default:t(()=>[T(D(r.$t("messageBox.allRead")),1)]),_:1})]),g("div",Rt,[o(a,null,{default:t(()=>[T(D(r.$t("messageBox.viewMore")),1)]),_:1})])]),_:1},8,["class"])]),default:t(()=>[(p(!0),I(J,null,X(n.renderList,l=>(p(),y(e,{key:l.id,"action-layout":"vertical",style:O({opacity:l.status?.5:1})},{extra:t(()=>[l.messageType===0?(p(),y(C,{key:0,color:"gray"},{default:t(()=>[T("\u672A\u5F00\u59CB")]),_:1})):l.messageType===1?(p(),y(C,{key:1,color:"green"},{default:t(()=>[T("\u5DF2\u5F00\u901A")]),_:1})):l.messageType===2?(p(),y(C,{key:2,color:"blue"},{default:t(()=>[T("\u8FDB\u884C\u4E2D")]),_:1})):l.messageType===3?(p(),y(C,{key:3,color:"red"},{default:t(()=>[T("\u5373\u5C06\u5230\u671F")]),_:1})):E("",!0)]),default:t(()=>[g("div",{class:"item-wrap",onClick:L=>u(l)},[o(_,null,Ae({title:t(()=>[o(d,{size:4},{default:t(()=>[g("span",null,D(l.title),1),o(w,{type:"secondary"},{default:t(()=>[T(D(l.subTitle),1)]),_:2},1024)]),_:2},1024)]),description:t(()=>[g("div",null,[o(b,{ellipsis:{rows:1}},{default:t(()=>[T(D(l.content),1)]),_:2},1024),l.type==="message"?(p(),y(w,{key:0,class:"time-text"},{default:t(()=>[T(D(l.time),1)]),_:2},1024)):E("",!0)])]),_:2},[l.avatar?{name:"avatar",fn:t(()=>[o($,{shape:"circle"},{default:t(()=>[l.avatar?(p(),I("img",{key:0,src:l.avatar},null,8,Bt)):(p(),y(m,{key:1}))]),_:2},1024)]),key:"0"}:void 0]),1024)],8,Tt)]),_:2},1032,["style"]))),128)),n.renderList.length&&n.renderList.length<3?(p(),I("div",{key:0,style:O({height:(v-n.renderList.length)*86+"px"})},null,4)):E("",!0)]),_:1})}}});const Ft=U(It,[["__scopeId","data-v-92126260"]]),Pt=F({__name:"index",setup(n){const{loading:s,setLoading:c}=bt(!0),i=A("message"),{t:u}=Me(),v=qe({renderList:[],messageList:[]});We(v);const r=[{key:"message",title:u("messageBox.tab.title.message")},{key:"notice",title:u("messageBox.tab.title.notice")},{key:"todo",title:u("messageBox.tab.title.todo")}];async function h(){c(!0);try{const{data:e}=await Dt();v.messageList=e}catch{}finally{c(!1)}}async function C(e){const a=e.map(k=>k.id);await St({ids:a}),h()}const m=x(()=>v.messageList.filter(e=>i.value===e.type)),$=x(()=>m.value.filter(e=>!e.status).length),w=e=>v.messageList.filter(k=>k.type===e&&!k.status),d=e=>{const a=w(e);return a.length?`(${a.length})`:""},b=e=>{m.value.length&&C([...e])},_=()=>{v.messageList=[]};return h(),(e,a)=>{const k=He,l=Je,L=ce,S=Xe,P=Ye;return p(),y(P,{style:{display:"block"},loading:f(s)},{default:t(()=>[o(S,{activeKey:i.value,"onUpdate:activeKey":a[0]||(a[0]=B=>i.value=B),type:"rounded","destroy-on-hide":""},{extra:t(()=>[o(L,{type:"text",onClick:_},{default:t(()=>[T(D(e.$t("messageBox.tab.button")),1)]),_:1})]),default:t(()=>[(p(),I(J,null,X(r,B=>o(l,{key:B.key},{title:t(()=>[g("span",null,D(B.title)+D(d(B.key)),1)]),default:t(()=>[f(m).length?E("",!0):(p(),y(k,{key:0,status:"404"},{subtitle:t(()=>[T(D(e.$t("messageBox.noContent")),1)]),_:1})),o(Ft,{"render-list":f(m),"unread-count":f($),onItemClick:b},null,8,["render-list","unread-count"])]),_:2},1024)),64))]),_:1},8,["activeKey"])]),_:1},8,["loading"])}}});const At=U(Pt,[["__scopeId","data-v-84c40e46"]]),Ut={class:"navbar"},zt={class:"left-side"},Nt=["src"],Kt={class:"center-side"},Ot={class:"right-side"},Vt={class:"message-box-trigger"},jt=["src"],qt=["src"],Wt=F({__name:"index",setup(n){const s=z(),c=V(),{logout:i}=kt(),{isFullscreen:u,toggle:v}=mt(),r=x(()=>c.avatar),h=x(()=>s.theme),C=x(()=>s.topMenu&&s.menu),m=gt({selector:"body",attribute:"arco-theme",valueDark:"dark",valueLight:"light",storageKey:"arco-theme",onChanged(a){s.toggleTheme(a)}}),$=vt(m),w=()=>{$()},d=A(),b=()=>{const a=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});d.value.dispatchEvent(a)},_=()=>{i()},e=Ge("toggleDrawerMenu");return(a,k)=>{const l=Qe,L=M("icon-menu-fold"),S=ae,P=M("icon-moon-fill"),B=M("icon-sun-fill"),R=ce,K=Ze,fe=M("icon-notification"),he=et,me=tt,ge=M("icon-fullscreen-exit"),ve=M("icon-fullscreen"),ye=se,be=M("icon-user"),G=re,ke=M("icon-export"),xe=le;return p(),I("div",Ut,[g("div",zt,[o(S,null,{default:t(()=>[g("img",{alt:"logo",src:f(te),style:{width:"40px"}},null,8,Nt),o(l,{style:{margin:0,fontSize:"18px"},heading:5},{default:t(()=>[T(D(f(s).title),1)]),_:1}),!f(C)&&f(s).device==="mobile"?(p(),y(L,{key:0,style:{"font-size":"22px",cursor:"pointer"},onClick:f(e)},null,8,["onClick"])):E("",!0)]),_:1})]),g("div",Kt,[f(C)?(p(),y(q,{key:0})):E("",!0)]),g("ul",Ot,[g("li",null,[o(K,{content:f(h)==="light"?a.$t("settings.navbar.theme.toDark"):a.$t("settings.navbar.theme.toLight")},{default:t(()=>[o(R,{class:"nav-btn",type:"outline",shape:"circle",onClick:w},{icon:t(()=>[f(h)==="dark"?(p(),y(P,{key:0})):(p(),y(B,{key:1}))]),_:1})]),_:1},8,["content"])]),g("li",null,[o(K,{content:a.$t("settings.navbar.alerts")},{default:t(()=>[g("div",Vt,[o(he,{count:9,dot:""},{default:t(()=>[o(R,{class:"nav-btn",type:"outline",shape:"circle",onClick:b},{default:t(()=>[o(fe)]),_:1})]),_:1})])]),_:1},8,["content"]),o(me,{trigger:"click","arrow-style":{display:"none"},"content-style":{padding:0,minWidth:"400px"},"content-class":"message-popover"},{content:t(()=>[o(At)]),default:t(()=>[g("div",{ref_key:"refBtn",ref:d,class:"ref-btn"},null,512)]),_:1})]),g("li",null,[o(K,{content:f(u)?a.$t("settings.navbar.screen.toExit"):a.$t("settings.navbar.screen.toFull")},{default:t(()=>[o(R,{class:"nav-btn",type:"outline",shape:"circle",onClick:f(v)},{icon:t(()=>[f(u)?(p(),y(ge,{key:0})):(p(),y(ve,{key:1}))]),_:1},8,["onClick"])]),_:1},8,["content"])]),g("li",null,[o(xe,{trigger:"click"},{content:t(()=>[o(G,null,{default:t(()=>[o(S,null,{default:t(()=>[o(be),g("span",null,D(a.$t("menu.user")),1)]),_:1})]),_:1}),o(G,null,{default:t(()=>[o(S,{onClick:_},{default:t(()=>[o(ke),g("span",null,D(a.$t("messageBox.logout")),1)]),_:1})]),_:1})]),default:t(()=>[o(ye,{size:32,style:{marginRight:"8px",cursor:"pointer"}},{default:t(()=>[f(r)=="logo.png"?(p(),I("img",{key:0,alt:"avatar",src:f(te)},null,8,jt)):(p(),I("img",{key:1,alt:"avatar",src:a.$staticUrl+f(r)},null,8,qt))]),_:1})]),_:1})])])])}}});const Ht=U(Wt,[["__scopeId","data-v-73af3ba5"]]);const N=n=>(ie("data-v-17257cfa"),n=n(),ue(),n),Jt={class:"tag-link"},Xt=N(()=>g("span",null,"\u91CD\u65B0\u52A0\u8F7D",-1)),Yt=N(()=>g("span",null,"\u5173\u95ED\u5F53\u524D\u6807\u7B7E\u9875",-1)),Gt=N(()=>g("span",null,"\u5173\u95ED\u5DE6\u4FA7\u6807\u7B7E\u9875",-1)),Qt=N(()=>g("span",null,"\u5173\u95ED\u53F3\u4FA7\u6807\u7B7E\u9875",-1)),Zt=N(()=>g("span",null,"\u5173\u95ED\u5176\u5B83\u6807\u7B7E\u9875",-1)),en=N(()=>g("span",null,"\u5173\u95ED\u5168\u90E8\u6807\u7B7E\u9875",-1)),tn=F({__name:"tab-item",props:{itemData:{type:Object,default(){return[]}},index:{type:Number,default:0}},setup(n){const s=n,c=j(),i=Y(),u=W(),v=_=>{c.push({..._})},r=x(()=>u.getTabList),h=x(()=>s.itemData.fullPath!==i.fullPath),C=x(()=>s.index===0),m=x(()=>[0,1].includes(s.index)),$=x(()=>s.index===r.value.length-1),w=(_,e)=>{if(u.deleteTag(e,_),s.itemData.fullPath===i.fullPath){const a=r.value[e-1];c.push({name:a.name})}},d=()=>r.value.findIndex(_=>_.fullPath===i.fullPath),b=async _=>{const{itemData:e,index:a}=s,k=[...r.value];if(_==="current")w(e,a);else if(_==="left"){const l=d();k.splice(1,s.index-1),u.freshTabList(k),l<a&&c.push({name:e.name})}else if(_==="right"){const l=d();k.splice(s.index+1),u.freshTabList(k),l>a&&c.push({name:e.name})}else if(_==="others"){const l=r.value.filter((L,S)=>S===0||S===s.index);u.freshTabList(l),c.push({name:e.name})}else _==="reload"?(u.deleteCache(e),await c.push({name:De,params:{path:i.fullPath}}),u.addCache(e.name)):(u.resetTabList(),c.push({name:Se}))};return(_,e)=>{const a=M("icon-close"),k=M("icon-refresh"),l=re,L=M("icon-to-left"),S=M("icon-to-right"),P=M("icon-swap"),B=M("icon-folder-delete"),R=le;return p(),y(R,{trigger:"contextMenu","popup-max-height":!1,onSelect:b},{content:t(()=>[o(l,{disabled:f(h),value:"reload"},{default:t(()=>[o(k),Xt]),_:1},8,["disabled","value"]),o(l,{class:"sperate-line",disabled:f(C),value:"current"},{default:t(()=>[o(a),Yt]),_:1},8,["disabled","value"]),o(l,{disabled:f(m),value:"left"},{default:t(()=>[o(L),Gt]),_:1},8,["disabled","value"]),o(l,{class:"sperate-line",disabled:f($),value:"right"},{default:t(()=>[o(S),Qt]),_:1},8,["disabled","value"]),o(l,{value:"others"},{default:t(()=>[o(P),Zt]),_:1},8,["value"]),o(l,{value:"all"},{default:t(()=>[o(B),en]),_:1},8,["value"])]),default:t(()=>[g("span",{class:H(["arco-tag arco-tag-size-medium arco-tag-checked",{"link-activated":n.itemData.fullPath===_.$route.fullPath}]),onClick:e[1]||(e[1]=K=>v(n.itemData))},[g("span",Jt,D(_.$t(n.itemData.title)),1),g("span",{class:"arco-icon-hover arco-tag-icon-hover arco-icon-hover-size-medium arco-tag-close-btn",onClick:e[0]||(e[0]=nt(K=>w(n.itemData,n.index),["stop"]))},[o(a)])],2)]),_:1})}}});const nn=U(tn,[["__scopeId","data-v-17257cfa"]]),on=n=>(ie("data-v-509db106"),n=n(),ue(),n),sn={class:"tab-bar-container"},an={class:"tab-bar-box"},cn={class:"tab-bar-scroll"},rn={class:"tags-wrap"},ln=on(()=>g("div",{class:"tag-bar-operation"},null,-1)),un=F({__name:"index",setup(n){const s=z(),c=W(),i=A(),u=x(()=>c.getTabList),v=x(()=>s.navbar?60:0);return de(()=>s.navbar,()=>{i.value.updatePosition()}),ne(r=>{!r.meta.noAffix&&!u.value.some(h=>h.fullPath===r.fullPath)&&c.updateTabList(r)},!0),ot(()=>{Te()}),(r,h)=>{const C=st;return p(),I("div",sn,[o(C,{ref_key:"affixRef",ref:i,"offset-top":f(v)},{default:t(()=>[g("div",an,[g("div",cn,[g("div",rn,[(p(!0),I(J,null,X(f(u),(m,$)=>(p(),y(nn,{key:m.fullPath,index:$,"item-data":m},null,8,["index","item-data"]))),128))])]),ln])]),_:1},8,["offset-top"])])}}});const dn=U(un,[["__scopeId","data-v-509db106"]]);function _n(n,s,c,i=!1){n.addEventListener&&typeof n.addEventListener=="function"&&n.addEventListener(s,c,i)}function pn(n,s,c,i=!1){n.removeEventListener&&typeof n.removeEventListener=="function"&&n.removeEventListener(s,c,i)}const fn=992;function hn(){return document.body.getBoundingClientRect().width-1<fn}function mn(n){const s=z();function c(){if(!document.hidden){const u=hn();s.toggleDevice(u?"mobile":"desktop"),s.toggleMenu(u)}}const i=yt(c,100);_e(()=>{n&&i()}),at(()=>{_n(window,"resize",i)}),ct(()=>{pn(window,"resize",i)})}const gn=F({__name:"page-layout",setup(n){const s=W(),c=x(()=>s.getCacheList);return(i,u)=>{const v=M("router-view");return p(),y(v,null,{default:t(({Component:r,route:h})=>[o(rt,{name:"fade",mode:"out-in",appear:""},{default:t(()=>[h.meta.ignoreCache?(p(),y(ee(r),{key:h.fullPath})):(p(),y(lt,{key:1,include:f(c)},[(p(),y(ee(r),{key:h.fullPath}))],1032,["include"]))]),_:2},1024)]),_:1})}}}),vn={key:0,class:"layout-navbar"},yn={class:"menu-wrapper"},bn=F({__name:"default-layout",setup(n){const s=A(!1),c=z(),i=V(),u=j(),v=Y(),r=pe();mn(!0);const h="60px",C=x(()=>c.navbar),m=x(()=>c.menu&&!c.topMenu),$=x(()=>c.hideMenu),w=x(()=>c.footer),d=x(()=>c.menuCollapse?48:c.menuWidth),b=x(()=>c.menuCollapse),_=x(()=>{const l=m.value&&!$.value?{paddingLeft:`${d.value}px`}:{},L=C.value?{paddingTop:h}:{};return{...l,...L}}),e=l=>{!s.value||c.updateSettings({menuCollapse:l})};de(()=>i.role,l=>{l&&!r.accessRouter(v)&&u.push({name:"notFound"})});const a=A(!1),k=()=>{a.value=!1};return ht("toggleDrawerMenu",()=>{a.value=!a.value}),_e(()=>{s.value=!0}),(l,L)=>{const S=dt,P=_t,B=pt,R=ft;return p(),y(R,{class:H(["layout",{mobile:f(c).hideMenu}])},{default:t(()=>[f(C)?(p(),I("div",vn,[o(Ht)])):E("",!0),o(R,null,{default:t(()=>[o(R,null,{default:t(()=>[f(m)?it((p(),y(S,{key:0,class:"layout-sider",breakpoint:"xl",collapsed:f(b),collapsible:!0,width:f(d),style:O({paddingTop:f(C)?"60px":""}),"hide-trigger":!0,onCollapse:e},{default:t(()=>[g("div",yn,[o(q)])]),_:1},8,["collapsed","width","style"])),[[ut,!f($)]]):E("",!0),f($)?(p(),y(P,{key:1,visible:a.value,placement:"left",footer:!1,"mask-closable":"",closable:!1,onCancel:k},{default:t(()=>[o(q)]),_:1},8,["visible"])):E("",!0),o(R,{class:"layout-content",style:O(f(_))},{default:t(()=>[f(c).tabBar?(p(),y(dn,{key:0})):E("",!0),o(B,null,{default:t(()=>[o(gn)]),_:1}),f(w)?(p(),y(Be,{key:1})):E("",!0)]),_:1},8,["style"])]),_:1})]),_:1})]),_:1},8,["class"])}}});const Un=U(bn,[["__scopeId","data-v-a4864bc3"]]);export{Un as default};
