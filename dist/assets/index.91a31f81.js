import{d as G,_ as we}from"./index.16f36a6f.js";/* empty css              *//* empty css               *//* empty css                *//* empty css              *//* empty css                *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css              */import{d as ke,e as r,r as Ve,c as xe,w as Ae,aG as _,aW as Se,bw as Te,bx as Ue,b5 as Ie,by as Ne,aT as Oe,bs as ze,bE as Re,b6 as $e,bp as qe,bk as Me,bF as Le,b2 as Pe,bl as Ge,bv as Je,bG as We,b7 as je,aX as Ke,bz as Xe,B as s,C as k,aJ as u,aI as a,aV as V,bA as C,aD as p,aN as l,F as m,aL as J,aK as W,aO as B,aE as I,u as He,a$ as Qe,n as Ye,bf as Ze,bq as ea,b3 as aa,bm as ta,bB as ua,D as oa,bD as na}from"./arco.a57bda95.js";import{u as la}from"./loading.6f29e790.js";import{g as sa,a as ia,u as j,d as da}from"./role.ca452619.js";import{S as ca,c as N}from"./sortable.esm.0dde07ee.js";import{g as ra}from"./team.5b92fd8c.js";import _a from"./SelectTeam.ec8c0dd7.js";import"./chart.bcf2bc51.js";import"./vue.7a37bc5c.js";const pa={class:"container"},ma={class:"action-icon"},va={class:"action-icon"},fa={id:"tableSetting"},ga={style:{"margin-right":"4px",cursor:"move"}},Fa={class:"title"},ba={name:"Role"},Ca=ke({...ba,setup(Ba){const F=r(!1),h=r(!1),O=r(),{loading:K,setLoading:z}=la(!0),x=r([]),R=r([]),n=r({}),v=r([]),D=r([]),A=r("medium"),y=Ve({...{current:1,pageSize:20}}),X=xe(()=>[{title:"\u89D2\u8272\u540D\u79F0",dataIndex:"name",slotName:"name"},{title:"\u89D2\u8272\u6807\u8BC6",dataIndex:"keyword"},{title:"\u89D2\u8272\u72B6\u6001",dataIndex:"status",slotName:"status"},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"created_at",slotName:"createdAt"},{title:"\u66F4\u65B0\u65F6\u95F4",dataIndex:"updated_at",slotName:"updatedAt"},{title:"\u64CD\u4F5C\u4EBA\u5458",dataIndex:"operator"},{title:"\u64CD\u4F5C",dataIndex:"operations",slotName:"operations"}]),H=async o=>{const{data:e}=await ra(o);R.value=[e]},E=async o=>{z(!0);try{const{data:e}=await sa(o);x.value=[e],y.current=1,y.total=e.length}finally{z(!1)}};E(),H();const Q=(o,e)=>{A.value=o},Y=(o,e,i)=>{o?v.value.splice(i,0,e):v.value=D.value.filter(d=>d.dataIndex!==e.dataIndex)},Z=o=>{const e=o.status?"\u542F\u7528":"\u7981\u7528";Qe.info({title:"\u72B6\u6001\u53D8\u66F4\u63D0\u793A",content:()=>`\u60A8\u786E\u8BA4\u8981 '${e}'\u6B64\u89D2\u8272\uFF1F`,closable:!0,hideCancel:!1,onOk:async()=>{j(o).then(()=>{V.success("\u66F4\u65B0\u6210\u529F")}).catch(()=>{o.status=!o.status})},onCancel:()=>{o.status=!o.status}})},$=o=>{n.value={},o&&(n.value.parent_id=o),n.value.status=!0,h.value=!0,F.value=!0},ee=async o=>{await da({id:o}),await E(),V.success("\u5220\u9664\u6210\u529F")},ae=o=>{n.value=G(o),o.data_scope==="CUSTOM"?n.value.team_ids=JSON.parse(o.team_ids):n.value.team_ids=[],h.value=!1,F.value=!0},te=async()=>{if(await O.value.validate())return!1;const e=G(n.value);return e.data_scope==="CUSTOM"?e.team_ids=JSON.stringify(e.team_ids):e.team_ids=null,h.value?(await ia(e),V.success("\u521B\u5EFA\u6210\u529F")):(await j(e),V.success("\u66F4\u65B0\u6210\u529F")),await E(),!0},q=(o,e,i,d=!1)=>{const c=d?N(o):o;return e>-1&&i>-1&&c.splice(e,1,c.splice(i,1,c[e]).pop()),c},ue=o=>{o&&Ye(()=>{const e=document.getElementById("tableSetting");new ca(e,{onEnd(i){const{oldIndex:d,newIndex:c}=i;q(v.value,d,c),q(D.value,d,c)}})})};return Ae(()=>X.value,o=>{v.value=N(o),v.value.forEach((e,i)=>{e.checked=!0}),D.value=N(v.value)},{deep:!0,immediate:!0}),(o,e)=>{const i=_("Breadcrumb"),d=_("icon-plus"),c=Se,M=Ze,oe=_("icon-refresh"),S=Te,ne=_("icon-line-height"),le=na,se=Ue,ie=_("icon-settings"),de=_("icon-drag-arrow"),ce=Ie,re=Ne,_e=ea,pe=Oe,T=ze,me=_("icon-edit"),ve=_("icon-delete"),fe=Re,ge=$e,Fe=qe,be=Me,Ce=Le,f=aa,L=Pe,P=Ge,Be=ta,w=ua,he=Je,De=We,ye=je,Ee=Ke,b=Xe("permission");return s(),k("div",pa,[u(i),u(be,{class:"general-card",title:"\u89D2\u8272\u7BA1\u7406"},{default:a(()=>[u(_e,{style:{"margin-bottom":"16px","align-items":"center"}},{default:a(()=>[u(M,{span:12},{default:a(()=>[C((s(),p(c,{type:"primary",onClick:e[0]||(e[0]=t=>$())},{icon:a(()=>[u(d)]),default:a(()=>[l(" \u521B\u5EFA ")]),_:1})),[[b,"system:role:add"]])]),_:1}),u(M,{span:12,style:{display:"flex",flex:"1","align-items":"center","justify-content":"end"}},{default:a(()=>[u(S,{content:"\u5237\u65B0"},{default:a(()=>[m("div",{class:"action-icon",onClick:E},[u(oe,{size:"18"})])]),_:1}),u(se,{onSelect:Q},{content:a(()=>[(s(!0),k(J,null,W(o.$densityList,t=>(s(),p(le,{key:t.value,value:t.value,class:oa({active:t.value===A.value})},{default:a(()=>[m("span",null,B(t.name),1)]),_:2},1032,["value","class"]))),128))]),default:a(()=>[u(S,{content:"\u5B57\u4F53\u5927\u5C0F"},{default:a(()=>[m("div",ma,[u(ne,{size:"18"})])]),_:1})]),_:1}),u(S,{content:"\u884C\u8BBE\u7F6E"},{default:a(()=>[u(re,{trigger:"click",position:"bl",onPopupVisibleChange:ue},{content:a(()=>[m("div",fa,[(s(!0),k(J,null,W(D.value,(t,g)=>(s(),k("div",{key:t.dataIndex,class:"setting"},[m("div",ga,[u(de)]),m("div",null,[u(ce,{modelValue:t.checked,"onUpdate:modelValue":U=>t.checked=U,onChange:U=>Y(U,t,g)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),m("div",Fa,B(t.title==="#"?"index":t.title),1)]))),128))])]),default:a(()=>[m("div",va,[u(ie,{size:"18"})])]),_:1})]),_:1})]),_:1})]),_:1}),C((s(),p(Fe,{"row-key":"id",loading:He(K),columns:v.value,data:x.value,bordered:!1,size:A.value},{index:a(({rowIndex:t})=>[l(B(t+1+(y.current-1)*y.pageSize),1)]),status:a(({record:t})=>[u(pe,{modelValue:t.status,"onUpdate:modelValue":g=>t.status=g,type:"round",onChange:g=>Z(t)},{checked:a(()=>[l(" \u542F\u7528 ")]),unchecked:a(()=>[l(" \u7981\u7528 ")]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),createdAt:a(({record:t})=>[l(B(o.$formatTime(t.created_at)),1)]),updatedAt:a(({record:t})=>[l(B(o.$formatTime(t.updated_at)),1)]),operations:a(({record:t})=>[u(ge,{class:"cursor-pointer"},{default:a(()=>[C((s(),p(T,{color:"arcoblue",onClick:g=>$(t.id)},{icon:a(()=>[u(d)]),default:a(()=>[l(" \u65B0\u5EFA ")]),_:2},1032,["onClick"])),[[b,"system:role:add"]]),t.id!=1?C((s(),p(T,{key:0,color:"arcoblue",onClick:g=>ae(t)},{icon:a(()=>[u(me)]),default:a(()=>[l("\u4FEE\u6539 ")]),_:2},1032,["onClick"])),[[b,"system:role:update"]]):I("",!0),C((s(),p(fe,{content:"\u60A8\u786E\u8BA4\u5220\u9664\u6B64\u89D2\u8272",type:"warning",onOk:g=>ee(t.id)},{default:a(()=>[t.id!=1?(s(),p(T,{key:0,color:"red"},{icon:a(()=>[u(ve)]),default:a(()=>[l("\u5220\u9664 ")]),_:1})):I("",!0)]),_:2},1032,["onOk"])),[[b,"system:role:delete"]])]),_:2},1024)]),_:1},8,["loading","columns","data","size"])),[[b,"system:role:query"]])]),_:1}),u(Ee,{visible:F.value,"onUpdate:visible":e[8]||(e[8]=t=>F.value=t),title:h.value?"\u521B\u5EFA":"\u4FEE\u6539",width:"380px",onCancel:e[9]||(e[9]=t=>F.value=!1),onBeforeOk:te},{default:a(()=>[u(ye,{ref_key:"submitFormRef",ref:O,model:n.value,"label-align":"left",layout:"horizontal","auto-label-width":""},{default:a(()=>[u(f,{field:"parent_id",label:"\u7236\u89D2\u8272",rules:[{required:!0,message:"\u7236\u89D2\u8272\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:a(()=>[u(Ce,{modelValue:n.value.parent_id,"onUpdate:modelValue":e[1]||(e[1]=t=>n.value.parent_id=t),"check-strictly":"",options:x.value,"field-names":{value:"id",label:"name"},placeholder:"\u8BF7\u9009\u62E9\u7236\u89D2\u8272","allow-search":""},null,8,["modelValue","options"])]),_:1}),u(f,{field:"name",label:"\u89D2\u8272\u540D\u79F0",rules:[{required:!0,message:"\u89D2\u8272\u540D\u79F0\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:a(()=>[u(L,{modelValue:n.value.name,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value.name=t),"allow-clear":"",placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0"},null,8,["modelValue"])]),_:1}),u(f,{field:"keyword",label:"\u89D2\u8272\u6807\u8BC6",rules:[{required:!0,message:"\u89D2\u8272\u6807\u8BC6\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:a(()=>[u(L,{modelValue:n.value.keyword,"onUpdate:modelValue":e[3]||(e[3]=t=>n.value.keyword=t),"allow-clear":"",placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u6807\u8BC6"},null,8,["modelValue"])]),_:1}),u(f,{field:"status",label:"\u89D2\u8272\u72B6\u6001",rules:[{required:!0,message:"\u89D2\u8272\u72B6\u6001\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:a(()=>[u(Be,{modelValue:n.value.status,"onUpdate:modelValue":e[4]||(e[4]=t=>n.value.status=t),"default-value":!0},{default:a(()=>[u(P,{value:!0},{default:a(()=>[l("\u542F\u7528")]),_:1}),u(P,{value:!1},{default:a(()=>[l("\u7981\u7528")]),_:1})]),_:1},8,["modelValue"])]),_:1}),u(f,{field:"data_scope",label:"\u89D2\u8272\u6743\u9650",rules:[{required:!0,message:"\u89D2\u8272\u6743\u9650\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:a(()=>[u(he,{modelValue:n.value.data_scope,"onUpdate:modelValue":e[5]||(e[5]=t=>n.value.data_scope=t),"allow-search":"",placeholder:"\u6570\u636E\u6743\u9650"},{default:a(()=>[u(w,{value:"ALLTEAM"},{default:a(()=>[l("\u6240\u5728\u90E8\u95E8\u53CA\u5B50\u90E8\u95E8")]),_:1}),u(w,{value:"CURTEAM"},{default:a(()=>[l("\u4EC5\u6240\u5728\u90E8\u95E8")]),_:1}),u(w,{value:"DOWNTEAM"},{default:a(()=>[l("\u4EC5\u5B50\u90E8\u95E8")]),_:1}),u(w,{value:"CUSTOM"},{default:a(()=>[l("\u81EA\u5B9A\u4E49\u90E8\u95E8")]),_:1})]),_:1},8,["modelValue"])]),_:1}),n.value.data_scope==="CUSTOM"?(s(),p(f,{key:0,field:"description",label:"\u89D2\u8272\u63CF\u8FF0",rules:[{required:!0,message:"\u89D2\u8272\u63CF\u8FF0\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:a(()=>[u(_a,{keys:n.value.team_ids,data:R.value,onSelect:e[6]||(e[6]=t=>{n.value.team_ids=t})},null,8,["keys","data"])]),_:1})):I("",!0),u(f,{field:"description",label:"\u89D2\u8272\u63CF\u8FF0",rules:[{required:!0,message:"\u89D2\u8272\u63CF\u8FF0\u662F\u5FC5\u586B\u9879"}],"validate-trigger":["change","input"]},{default:a(()=>[u(De,{modelValue:n.value.description,"onUpdate:modelValue":e[7]||(e[7]=t=>n.value.description=t),"allow-clear":"",placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u63CF\u8FF0"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"])])}}});const Pa=we(Ca,[["__scopeId","data-v-5f5e700f"]]);export{Pa as default};
